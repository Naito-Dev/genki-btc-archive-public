<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Technical Verification & Reproducibility Center | Genki BTC</title>
  <style>
    :root {
      --bg:#060b14;
      --panel:#0f1d35;
      --line:rgba(122,159,225,.28);
      --text:#f2f6ff;
      --muted:#aebddb;
      --soft:#7f91b4;
      --gold:#d8b24a;
      --ok:#5fd19a;
      --warn:#f3c96b;
    }
    * { box-sizing:border-box; }
    body {
      margin:0;
      font-family:Inter,system-ui,-apple-system,sans-serif;
      background:linear-gradient(180deg,#05090f,#0a1630);
      color:var(--text);
    }
    .wrap { width:min(960px,92vw); margin:24px auto 40px; }
    .lang {
      display:flex;
      gap:8px;
      justify-content:flex-end;
      margin-bottom:12px;
    }
    .lang a {
      color:var(--muted);
      text-decoration:none;
      border:1px solid var(--line);
      border-radius:999px;
      padding:4px 10px;
      font-size:12px;
      font-weight:700;
      letter-spacing:.06em;
      text-transform:uppercase;
    }
    .lang a.active {
      color:var(--text);
      border-color:var(--gold);
      background:rgba(216,178,74,.14);
    }
    .back-nav {
      margin:0 0 10px;
    }
    .back-btn {
      display:inline-flex;
      align-items:center;
      gap:6px;
      color:var(--muted);
      text-decoration:none;
      border:1px solid var(--line);
      border-radius:999px;
      padding:6px 12px;
      font-size:12px;
      font-weight:700;
      letter-spacing:.02em;
      background:rgba(8,18,36,.28);
    }
    .back-btn:hover {
      color:var(--text);
      border-color:var(--gold);
      background:rgba(216,178,74,.10);
    }
    .lang-section[hidden] { display:none; }
    .panel {
      background:var(--panel);
      border:1px solid var(--line);
      border-radius:16px;
      padding:18px;
      margin-top:10px;
    }
    h1,h2,h3 { margin:0 0 10px; letter-spacing:-.01em; }
    h1 { font-size:clamp(26px,4vw,36px); }
    h2 { font-size:clamp(22px,3vw,30px); }
    h3 { font-size:16px; color:var(--text); margin-bottom:8px; }
    p,li { color:var(--muted); line-height:1.55; margin:0; }
    ul { margin:8px 0 0; padding-left:18px; display:grid; gap:4px; }
    .grid {
      display:grid;
      gap:10px;
      grid-template-columns:repeat(2,minmax(0,1fr));
      margin-top:8px;
    }
    .subcard {
      border:1px solid rgba(122,159,225,.2);
      border-radius:12px;
      padding:12px;
      background:rgba(8,18,36,.46);
    }
    .subtle { color:var(--soft); font-size:13px; margin-top:6px; }
    .links { display:grid; gap:8px; margin-top:8px; }
    .links a { color:#f6d57b; text-decoration:none; word-break:break-word; }
    .planned {
      margin-top:8px;
      display:grid;
      gap:6px;
      font-size:14px;
    }
    .planned span {
      display:inline-flex;
      align-items:center;
      gap:8px;
      color:var(--muted);
    }
    .badge {
      font-size:11px;
      border:1px solid var(--line);
      border-radius:999px;
      padding:2px 8px;
      color:var(--warn);
      white-space:nowrap;
    }
    .ok { color:var(--ok); }
    .divider {
      margin:16px 0;
      border:0;
      height:1px;
      background:linear-gradient(90deg,transparent,rgba(122,159,225,.28),transparent);
    }
    .footnote {
      margin-top:8px;
      font-size:12px;
      color:var(--soft);
    }
    .log-table-wrap {
      margin-top:10px;
      border:1px solid rgba(122,159,225,.2);
      border-radius:12px;
      overflow:auto;
      background:rgba(8,18,36,.46);
    }
    .log-table {
      width:100%;
      border-collapse:collapse;
      min-width:860px;
      font-size:12px;
    }
    .log-table th,
    .log-table td {
      padding:8px 10px;
      border-bottom:1px solid rgba(122,159,225,.18);
      color:var(--muted);
      text-align:left;
      vertical-align:top;
      white-space:nowrap;
    }
    .log-table th {
      color:var(--text);
      font-size:11px;
      letter-spacing:.04em;
      text-transform:uppercase;
      background:rgba(10,20,40,.42);
      position:sticky;
      top:0;
      z-index:1;
    }
    .log-table td.ok { color:var(--ok); font-weight:700; }
    .hash {
      font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
      color:var(--soft);
      max-width:220px;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .proof-summary {
      margin-top:10px;
      display:grid;
      gap:8px;
      grid-template-columns:repeat(2,minmax(0,1fr));
    }
    .summary-item {
      border:1px solid rgba(122,159,225,.2);
      border-radius:10px;
      background:rgba(8,18,36,.38);
      padding:10px;
    }
    .summary-label {
      font-size:11px;
      letter-spacing:.04em;
      text-transform:uppercase;
      color:var(--soft);
      margin-bottom:4px;
    }
    .summary-value {
      color:var(--text);
      font-weight:700;
      font-size:14px;
      line-height:1.3;
    }
    .summary-value.warn { color:var(--warn); }
    .summary-value.muted { color:var(--soft); }
    .audit-summary {
      margin-top:10px;
      display:grid;
      gap:8px;
      grid-template-columns:repeat(2,minmax(0,1fr));
    }
    .audit-summary .summary-item {
      border:1px solid rgba(122,159,225,.2);
      border-radius:10px;
      background:rgba(8,18,36,.38);
      padding:10px;
    }
    .alloc-locked {
      font-size:11px;
      color:var(--soft);
      white-space:nowrap;
      letter-spacing:.01em;
    }
    @media (max-width: 820px) {
      .grid { grid-template-columns:1fr; }
      .proof-summary { grid-template-columns:1fr; }
      .audit-summary { grid-template-columns:1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <nav class="lang" aria-label="Language switch">
      <a href="#en" data-lang="en" aria-current="page">EN</a>
      <a href="#ja" data-lang="ja">JA</a>
    </nav>
    <div class="back-nav">
      <a class="back-btn" href="https://naito-dev.github.io/genki-btc-archive-public/" id="backLink">← Back</a>
    </div>

    <section class="panel lang-section" id="en">
      <h1>Technical Verification & Reproducibility Center</h1>
      <p>Proprietary strategy logic remains private. Verification artifacts and reproducibility context are published here for transparency.</p>

      <div class="grid">
        <article class="subcard">
          <h3>Live Verification (Public)</h3>
          <ul>
            <li>Daily public dashboard status and signal state</li>
            <li>Public proof records and timestamped updates</li>
            <li>Operational continuity and safety-state visibility</li>
          </ul>
        </article>
        <article class="subcard">
          <h3>Historical Reference Metrics</h3>
          <ul>
            <li>Historical metrics are reference-only</li>
            <li>Not a promise of future returns</li>
            <li>Used to provide context, not guarantees</li>
          </ul>
        </article>
      </div>

      <hr class="divider" />

      <h3>Public Verification Links</h3>
      <div class="links">
        <a href="https://naito-dev.github.io/genki-btc-archive-public/">Public Dashboard</a>
        <a href="https://raw.githubusercontent.com/Naito-Dev/genki-btc-archive-public/main/log.json">Public proof records (log.json)</a>
        <a href="https://github.com/Naito-Dev/genki-btc-archive-public/blob/main/README.md">Backtest methodology (reference)</a>
        <a href="https://github.com/Naito-Dev/genki-btc-archive-public">Project documentation index (public repository)</a>
      </div>

      <h3 style="margin-top:14px">Human-Readable Proof Log (Latest 20)</h3>
      <p class="subtle">This is a readable view of public proof records from <code>log.json</code>. It does not expose proprietary strategy logic.</p>
      <div class="proof-summary" aria-label="Proof log summary">
        <div class="summary-item"><div class="summary-label">Total Records</div><div class="summary-value" id="summaryTotalEn">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">Latest Proof Time (UTC)</div><div class="summary-value" id="summaryTimeEn">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">Latest Chain Integrity</div><div class="summary-value" id="summaryIntegrityEn">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">Valid Records Ratio</div><div class="summary-value" id="summaryRatioEn">UNAVAILABLE</div></div>
      </div>
      <div class="audit-summary" aria-label="Audit comparison summary">
        <div class="summary-item"><div class="summary-label">Audit Status</div><div class="summary-value" id="auditStatusEn">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">Proof Chain Check</div><div class="summary-value" id="auditHashEn">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">Audit Metrics Available</div><div class="summary-value" id="auditMetricsEn">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">Generated At (UTC)</div><div class="summary-value" id="auditGeneratedEn">UNAVAILABLE</div></div>
      </div>
      <p class="subtle">Quick audit check for reproducibility and proof integrity. Detailed evidence is available in comparison.json.</p>
      <div class="log-table-wrap" aria-label="Human-readable proof log">
        <table class="log-table">
          <thead>
            <tr>
              <th>Day</th>
              <th>Date/UTC</th>
              <th>Chain Integrity</th>
              <th>Trigger</th>
              <th>Allocation</th>
              <th>BTC Price</th>
              <th>Hash</th>
              <th>Prev Hash</th>
            </tr>
          </thead>
          <tbody id="proofRowsEn">
            <tr><td colspan="8">Loading…</td></tr>
          </tbody>
        </table>
      </div>

      <hr class="divider" />

      <div class="grid">
        <article class="subcard">
          <h3>What is Public</h3>
          <ul>
            <li>Live status and proof records</li>
            <li>Historical reference metrics</li>
            <li>Audit and verification notes</li>
          </ul>
        </article>
        <article class="subcard">
          <h3>What is Private</h3>
          <ul>
            <li>Proprietary strategy logic</li>
            <li>Execution internals and IP implementation</li>
            <li>Private operational controls</li>
          </ul>
        </article>
      </div>

      <p class="subtle">Reproducibility policy: outputs are monitored and published, historical metrics are reference-only, and this center is for technical verification context. It is not investment advice.</p>

      <div class="planned" aria-label="Planned artifacts">
        <span><span class="badge">Planned</span> <code>audit_report.json</code> (coming soon)</span>
        <span><span class="badge">Planned</span> Reproducibility notes (coming soon)</span>
      </div>

      <p class="footnote">Past performance is not indicative of future results. Not investment advice.</p>
    </section>

    <section class="panel lang-section" id="ja">
      <h2>技術検証・再現性センター（上級者向け）</h2>
      <p>戦略ロジック本体（IP）は非公開のまま、検証可能性と再現性に必要な公開資料をここに集約します。</p>

      <div class="grid">
        <article class="subcard">
          <h3>ライブ検証（公開）</h3>
          <ul>
            <li>公開ダッシュボードの日次状態・シグナル</li>
            <li>公開証跡（proof records）と更新時刻</li>
            <li>安全状態を含む運用継続性の可視化</li>
          </ul>
        </article>
        <article class="subcard">
          <h3>ヒストリカル参考値</h3>
          <ul>
            <li>過去指標は参考値として公開</li>
            <li>将来収益の保証ではない</li>
            <li>判断補助の文脈提供が目的</li>
          </ul>
        </article>
      </div>

      <hr class="divider" />

      <h3>公開検証リンク</h3>
      <div class="links">
        <a href="https://naito-dev.github.io/genki-btc-archive-public/">公開ダッシュボード</a>
        <a href="https://raw.githubusercontent.com/Naito-Dev/genki-btc-archive-public/main/log.json">公開証跡（log.json）</a>
        <a href="https://github.com/Naito-Dev/genki-btc-archive-public/blob/main/README.md">バックテスト手法（参考）</a>
        <a href="https://github.com/Naito-Dev/genki-btc-archive-public">公開ドキュメント索引（リポジトリ）</a>
      </div>

      <h3 style="margin-top:14px">公開証跡ログ（読みやすい表示・最新20件）</h3>
      <p class="subtle"><code>log.json</code> の公開証跡を人間向けに整形表示しています。戦略ロジック本体は公開しません。</p>
      <div class="proof-summary" aria-label="公開証跡ログサマリー">
        <div class="summary-item"><div class="summary-label">公開記録の件数</div><div class="summary-value" id="summaryTotalJa">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">最新の公開記録時刻（UTC）</div><div class="summary-value" id="summaryTimeJa">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">最新記録の整合性</div><div class="summary-value" id="summaryIntegrityJa">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">有効な記録の割合</div><div class="summary-value" id="summaryRatioJa">UNAVAILABLE</div></div>
      </div>
      <div class="audit-summary" aria-label="監査比較サマリー">
        <div class="summary-item"><div class="summary-label">監査ステータス</div><div class="summary-value" id="auditStatusJa">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">証跡の改ざんチェック</div><div class="summary-value" id="auditHashJa">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">監査データの準備状態</div><div class="summary-value" id="auditMetricsJa">UNAVAILABLE</div></div>
        <div class="summary-item"><div class="summary-label">監査結果の作成時刻（UTC）</div><div class="summary-value" id="auditGeneratedJa">UNAVAILABLE</div></div>
      </div>
      <p class="subtle">この欄は「公開記録が改ざんされていないか」「監査に必要なデータがそろっているか」をすぐ確認するための表示です。詳しい内容は comparison.json で確認できます。</p>
      <div class="log-table-wrap" aria-label="公開証跡ログ（読みやすい表示）">
        <table class="log-table">
          <thead>
            <tr>
              <th>Day</th>
              <th>Date/UTC</th>
              <th>Chain Integrity</th>
              <th>Trigger</th>
              <th>Allocation</th>
              <th>BTC Price</th>
              <th>Hash</th>
              <th>Prev Hash</th>
            </tr>
          </thead>
          <tbody id="proofRowsJa">
            <tr><td colspan="8">読み込み中…</td></tr>
          </tbody>
        </table>
      </div>

      <hr class="divider" />

      <div class="grid">
        <article class="subcard">
          <h3>公開しているもの</h3>
          <ul>
            <li>ライブ状態と証跡レコード</li>
            <li>ヒストリカル参考値</li>
            <li>監査・検証ノート</li>
          </ul>
        </article>
        <article class="subcard">
          <h3>非公開のもの</h3>
          <ul>
            <li>戦略ロジック本体</li>
            <li>実行内部仕様・IP実装詳細</li>
            <li>内部運用コントロール</li>
          </ul>
        </article>
      </div>

      <p class="subtle">再現性ポリシー: 出力は監視・公開し、ヒストリカル指標は参考値として扱います。本ページは技術検証の文脈提供を目的とし、投資助言ではありません。</p>

      <div class="planned" aria-label="今後追加予定">
        <span><span class="badge">予定</span> <code>audit_report.json</code>（準備中）</span>
        <span><span class="badge">予定</span> 再現性ノート（準備中）</span>
      </div>

      <p class="footnote">過去実績は将来成果を保証しません。投資助言ではありません。</p>
    </section>
  </div>

  <script>
    (function () {
      function toNumber(v) {
        if (v === null || v === undefined) return null;
        const n = Number(String(v).replace(/[$,%\s,]/g, '').trim());
        return Number.isFinite(n) ? n : null;
      }

      function shortHash(v) {
        const s = String(v || '').trim();
        if (!s) return '—';
        if (s.length <= 16) return s;
        return s.slice(0, 8) + '…' + s.slice(-8);
      }

      function fmtUsd(v) {
        const n = toNumber(v);
        if (n === null) return '—';
        return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 2 }).format(n);
      }

      function fmtAllocation(_e, locale) {
        const text = locale === 'ja' ? '会員限定' : 'Members only';
        return `<span class="alloc-locked">${text}</span>`;
      }

      function fmtUtc(e) {
        const v = (e && (e.updated_at_utc || e.timestamp_utc || e.date)) || '';
        if (!v) return '—';
        const d = new Date(v);
        if (!Number.isFinite(d.getTime())) return String(v);
        const y = d.getUTCFullYear();
        const m = String(d.getUTCMonth() + 1).padStart(2, '0');
        const day = String(d.getUTCDate()).padStart(2, '0');
        const hh = String(d.getUTCHours()).padStart(2, '0');
        const mm = String(d.getUTCMinutes()).padStart(2, '0');
        return `${y}-${m}-${day} ${hh}:${mm}`;
      }

      function normDay(e, idx) {
        if (e && e.day) {
          const raw = String(e.day).trim();
          return raw.replace(/\s*\/\s*\d+\b/g, '');
        }
        return `Day ${idx + 1}`;
      }

      function sortByUtcDesc(entries) {
        return [...entries].sort((a, b) => {
          const ta = Date.parse((a && (a.updated_at_utc || a.timestamp_utc || a.date)) || '') || 0;
          const tb = Date.parse((b && (b.updated_at_utc || b.timestamp_utc || b.date)) || '') || 0;
          return tb - ta;
        });
      }

      function renderRows(tbody, entries, locale) {
        if (!tbody) return;
        if (!entries.length) {
          tbody.innerHTML = `<tr><td colspan="8">${locale === 'ja' ? '表示可能なレコードがありません。' : 'No records available.'}</td></tr>`;
          return;
        }

        const rows = entries.slice(0, 20).map((e, i) => {
          const integrity = String((e && e.chain_integrity) || '—');
          const trigger = String((e && (e.trigger || e.status || e.reason_summary)) || '—');
          return `<tr>
            <td>${normDay(e, i)}</td>
            <td>${fmtUtc(e)}</td>
            <td class="${integrity === 'VALID' ? 'ok' : ''}">${integrity}</td>
            <td>${trigger}</td>
            <td>${fmtAllocation(e, locale)}</td>
            <td>${fmtUsd(e && e.btc_price)}</td>
            <td class="hash" title="${String((e && e.hash) || '')}">${shortHash(e && e.hash)}</td>
            <td class="hash" title="${String((e && e.prev_hash) || '')}">${shortHash(e && e.prev_hash)}</td>
          </tr>`;
        }).join('');

        tbody.innerHTML = rows;
      }

      function updateSummary(locale, entries) {
        const suffix = locale === 'ja' ? 'Ja' : 'En';
        const totalEl = document.getElementById(`summaryTotal${suffix}`);
        const timeEl = document.getElementById(`summaryTime${suffix}`);
        const integrityEl = document.getElementById(`summaryIntegrity${suffix}`);
        const ratioEl = document.getElementById(`summaryRatio${suffix}`);
        if (!totalEl || !timeEl || !integrityEl || !ratioEl) return;

        if (!entries.length) {
          totalEl.textContent = 'UNAVAILABLE';
          timeEl.textContent = 'UNAVAILABLE';
          integrityEl.textContent = 'UNAVAILABLE';
          ratioEl.textContent = 'UNAVAILABLE';
          integrityEl.classList.add('muted');
          ratioEl.classList.add('muted');
          return;
        }

        const latest = entries[0];
        const latestIntegrity = String((latest && latest.chain_integrity) || 'UNAVAILABLE');
        const validCount = entries.filter((e) => String((e && e.chain_integrity) || '') === 'VALID').length;
        const proofTime = fmtUtc(latest);

        totalEl.textContent = String(entries.length);
        timeEl.textContent = proofTime;
        integrityEl.textContent = latestIntegrity;
        ratioEl.textContent = `${validCount}/${entries.length} VALID`;

        integrityEl.classList.remove('warn', 'muted');
        ratioEl.classList.remove('muted');
        if (latestIntegrity !== 'VALID') integrityEl.classList.add('warn');
      }

      function applyLang(lang) {
        const chosen = lang === 'ja' ? 'ja' : 'en';
        const enSection = document.getElementById('en');
        const jaSection = document.getElementById('ja');
        const links = document.querySelectorAll('.lang a[data-lang]');
        const backLink = document.getElementById('backLink');

        if (enSection) enSection.hidden = chosen !== 'en';
        if (jaSection) jaSection.hidden = chosen !== 'ja';

        links.forEach((a) => {
          const active = a.getAttribute('data-lang') === chosen;
          a.classList.toggle('active', active);
          if (active) a.setAttribute('aria-current', 'page');
          else a.removeAttribute('aria-current');
        });
        if (backLink) {
          backLink.textContent = chosen === 'ja' ? '← ダッシュボードに戻る' : '← Back to dashboard';
        }

        try { localStorage.setItem('verification_lang', chosen); } catch (_) {}
        if (location.hash !== `#${chosen}`) history.replaceState(null, '', `#${chosen}`);
      }

      function initLangSwitch() {
        const nav = document.querySelector('.lang');
        if (!nav) return;

        nav.addEventListener('click', function (ev) {
          const a = ev.target.closest('a[data-lang]');
          if (!a) return;
          ev.preventDefault();
          applyLang(a.getAttribute('data-lang'));
        });

        const hashLang = (location.hash || '').replace('#', '').toLowerCase();
        let saved = '';
        try { saved = String(localStorage.getItem('verification_lang') || '').toLowerCase(); } catch (_) {}
        applyLang(hashLang === 'ja' || hashLang === 'en' ? hashLang : (saved === 'ja' ? 'ja' : 'en'));
      }

      function initBackLink() {
        const backLink = document.getElementById('backLink');
        if (!backLink) return;
        backLink.addEventListener('click', function (ev) {
          if (window.history.length > 1) {
            ev.preventDefault();
            window.history.back();
          }
        });
      }

      function setAuditUnavailable(locale) {
        const suffix = locale === 'ja' ? 'Ja' : 'En';
        ['auditStatus', 'auditHash', 'auditMetrics', 'auditGenerated'].forEach((base) => {
          const el = document.getElementById(`${base}${suffix}`);
          if (!el) return;
          el.textContent = 'UNAVAILABLE';
          el.classList.add('muted');
          el.classList.remove('ok', 'warn');
        });
      }

      function setAuditSummary(locale, comparison) {
        const suffix = locale === 'ja' ? 'Ja' : 'En';
        const statusEl = document.getElementById(`auditStatus${suffix}`);
        const hashEl = document.getElementById(`auditHash${suffix}`);
        const metricsEl = document.getElementById(`auditMetrics${suffix}`);
        const genEl = document.getElementById(`auditGenerated${suffix}`);
        if (!statusEl || !hashEl || !metricsEl || !genEl) return;

        const status = String((comparison && comparison.comparison && comparison.comparison.status) || 'UNAVAILABLE');
        const checks = (comparison && comparison.comparison && comparison.comparison.checks) || {};
        const hashMatch = checks.hash_match;
        const metricsReady = checks.metrics_ready;
        const generatedAt = String((comparison && comparison.generated_at_utc) || 'UNAVAILABLE');
        const statusDisplay = status === 'MATCH' ? 'PASS' : (status === 'UNAVAILABLE' ? 'UNAVAILABLE' : 'FAIL');

        statusEl.textContent = statusDisplay;
        hashEl.textContent = typeof hashMatch === 'boolean' ? (hashMatch ? 'PASS' : 'FAIL') : 'UNAVAILABLE';
        metricsEl.textContent = typeof metricsReady === 'boolean' ? (metricsReady ? 'PASS' : 'FAIL') : 'UNAVAILABLE';
        genEl.textContent = generatedAt;

        [statusEl, hashEl, metricsEl, genEl].forEach((el) => el.classList.remove('muted', 'ok', 'warn'));
        if (statusDisplay === 'PASS') statusEl.classList.add('ok');
        else if (statusDisplay === 'FAIL') statusEl.classList.add('warn');
        else statusEl.classList.add('muted');
        if (hashMatch === true) hashEl.classList.add('ok');
        else if (hashMatch === false) hashEl.classList.add('warn');
        else hashEl.classList.add('muted');
        if (metricsReady === true) metricsEl.classList.add('ok');
        else if (metricsReady === false) metricsEl.classList.add('warn');
        else metricsEl.classList.add('muted');
        if (generatedAt === 'UNAVAILABLE') genEl.classList.add('muted');
      }

      async function hydrateAuditSummary() {
        try {
          const res = await fetch(`https://naito-dev.github.io/genki-btc-archive-public/output/audit/comparison.json?ts=${Date.now()}`, { cache: 'no-store' });
          if (!res.ok) throw new Error(`comparison_fetch_${res.status}`);
          const comparison = await res.json();
          setAuditSummary('en', comparison);
          setAuditSummary('ja', comparison);
          console.debug('[AUDIT_SUMMARY]', { status: comparison?.comparison?.status });
        } catch (err) {
          setAuditUnavailable('en');
          setAuditUnavailable('ja');
          console.debug('[AUDIT_SUMMARY]', { error: String(err) });
        }
      }

      async function hydrateProofTables() {
        const en = document.getElementById('proofRowsEn');
        const ja = document.getElementById('proofRowsJa');
        if (!en && !ja) return;

        try {
          const res = await fetch(`https://naito-dev.github.io/genki-btc-archive-public/log.json?ts=${Date.now()}`, { cache: 'no-store' });
          if (!res.ok) throw new Error(`log_fetch_${res.status}`);
          const log = await res.json();
          const entries = Array.isArray(log && log.entries) ? sortByUtcDesc(log.entries) : [];
          renderRows(en, entries, 'en');
          renderRows(ja, entries, 'ja');
          updateSummary('en', entries);
          updateSummary('ja', entries);
          console.debug('[PROOF_LOG_VIEW]', { count: entries.length });
        } catch (err) {
          if (en) en.innerHTML = '<tr><td colspan="8">UNAVAILABLE</td></tr>';
          if (ja) ja.innerHTML = '<tr><td colspan="8">UNAVAILABLE</td></tr>';
          updateSummary('en', []);
          updateSummary('ja', []);
          console.debug('[PROOF_LOG_VIEW]', { error: String(err) });
        }
      }

      initLangSwitch();
      initBackLink();
      hydrateAuditSummary();
      hydrateProofTables();
    })();
  </script>

</body>
</html>
